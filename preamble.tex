%% Slides for ".NET Programming" by Chunyu Wang <chunyu@hit.edu.cn> %%

% ,----[ 输出说明 ]
% |
% | 文档可以使用 beamer 文档类输出幻灯片，也可以使用 article 文档类输出内容。
% |
% |   * 使用 beamer 时，可以有两种输出模式：
% |     - 默认的 beamer 模式；
% |     - 可选的一般 handout 模式，使用 handout 选项；
% |     - 用于打印的 handout 模式，使用 handout 选项，设置 handoutprint 为 true；
% |
% |   * 使用 article 时，也可输出全部内容：
% |     - 需要加载 beamerarticle 宏包。
% |
% `----

\documentclass[13pt,xcolor=svgnames,table,xetex]{beamer} % 或使用 handout 选项

%\documentclass[a4paper]{article}                      % article only
%\usepackage[noxcolor]{beamerarticle}

\mode<handout>{%                % 用于打印的 handout 模式 (每页A4两帧)
  \RequirePackage{ifthen}       %
  \newboolean{handoutprint}     % 将该变量置为 true 即可
  \setboolean{handoutprint}{false}} % true

\mode<article>{%                % article only
  \usepackage[svgnames]{xcolor}
  \usepackage{amssymb}
  \usepackage{fullpage}}

\mode<presentation>{%           % presentation only
  \usetheme{Warsaw}
  \setbeamertemplate{background canvas}[vertical shading][bottom=red!10,top=blue!10]
  \setbeamercovered{transparent}
  \setbeamertemplate{headline}{%
    \begin{beamercolorbox}{section in head/foot}
      \vskip2pt\insertnavigation{\paperwidth}\vskip2pt
    \end{beamercolorbox}}%
  \usefonttheme{serif}
  \setbeamertemplate{background}[grid][step=.5cm]}

\usepackage{xeCJK}
\setCJKmainfont[BoldFont=黑体,ItalicFont=楷体]{楷体}
\setCJKsansfont{黑体}
\setCJKmonofont{仿宋}

\usepackage{listings}
\usepackage{tikz}
\usetikzlibrary{shapes,trees}
%\usepackage[english]{babel}

%% attachfile setup %%
% \usepackage{attachfile} % only work for pdflatex
% \attachfilesetup{icon=Tag,mimetype=text/plain,subject=Code Example}

%% C# language for listings %%
\lstdefinelanguage{CSharp}{%
  morekeywords={abstract, as, base, break, case, catch, checked, class,
    const, continue, default, delegate, do, else, enum, event, explicit,
    extern, false, finally, fixed, for, foreach, from, get, goto, group,
    if, implicit, in, interface, internal, is, join, let, lock, namespace,
    new, null, operator, orderby, out, override, params, partial, private,
    protected, public, readonly, ref, return, sealed, select, set, sizeof,
    stackalloc, static, struct, switch, this, throw, true, try, typeof,
    unchecked, unsafe, using, value, virtual, volatile, where, while},
  morekeywords={[2]bool, byte, char, decimal, double, float, int, long,
    object, sbyte, short, string, uint, ulong, ushort, void, var},
  otherkeywords={:,@},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[l]{///},
  morecomment=[s]{/*}{*/},
  morestring=[b]"}

%% listings setup %%
\mode<presentation>{%
  \lstset{basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color[rgb]{0.15,0.25,0.55}\bfseries,
    keywordstyle=[2]\color{ForestGreen!90!black}\bfseries,
    identifierstyle=,
    stringstyle=\color[rgb]{0.41,0.13,0.55}\ttfamily,
    showstringspaces=false,
    commentstyle=\color[rgb]{0.55,0.14,0.14}\ttfamily,
    emphstyle=\color{red!75}\bfseries,
    emphstyle=[2]\color{DarkMagenta}\bfseries,
    emphstyle=[3]\bfseries,
    emphstyle=[4]\sl,
    frameround=tttt,
    frame=single,
    framerule=1pt,
    rulecolor=\color[rgb]{0.18,0.55,0.34},
    backgroundcolor=\color{red!10}, %\color[rgb]{0.94,0.85,0.71},
    escapebegin=\sl\color[rgb]{0.55,0.14,0.14},
    escapeend=,
    language=CSharp}}
\mode<article>{%
  \lstset{basicstyle=\ttfamily\footnotesize, keywordstyle=\bfseries,
    keywordstyle=[2]\bfseries, commentstyle=\sl, emphstyle=\bfseries,
    emphstyle=[2]\bfseries, emphstyle=[3]\bfseries, emphstyle=[4]\sl,
    frame=none, framerule=0pt, backgroundcolor=\color{black!7},
    escapebegin=\sl, escapeend=, language=CSharp}}

%% hyperref setup %%
\hypersetup{%
  colorlinks=false,
  % bookmarks=true,
  bookmarksopen=true,
  pdfstartview=Fit,             % FitV
  pdffitwindow=true,
  pdfpagemode=None,             % FullScreen
  % pdfmenubar=false,
  % pdftoolbar=false,
  CJKbookmarks=true,
  % pdfauthor={Chunyu Wang <chunyu@hit.edu.cn>},
  pdftitle={Microsoft .NET Framework},
  pdfsubject={.NET Programming},
  pdfkeywords={.NET, C\#}}

\graphicspath{{figures/}}

%% logo definition %%
% \pgfdeclaremask{hit-mask}{logo/hit-mask}
% \pgfdeclareimage[mask=hit-mask,width=1.3cm]{hit-logo}{logo/hit-logol}
% \pgfdeclaremask{cs-mask}{logo/cs-mask}
% \pgfdeclareimage[mask=cs-mask,width=1.3cm]{cs-logo}{logo/cs-logo}
%\logo{\vbox{\hbox to 1.3cm{\hfil\pgfuseimage{cs-logo}}\vskip0.1cm\hbox{\pgfuseimage{hit-logo}}}}

\pgfdeclareimage[width=1.3cm]{logo-cs}{figures/logo-cs}
\pgfdeclareimage[width=1.3cm]{logo-hit}{figures/logo-hit}
%LOGO:
%\logo{\vbox{\hbox to 1.3cm{\pgfuseimage{logo-cs}}\vskip0.1cm\hbox to 1.3cm{\pgfuseimage{logo-hit}}}}

\AtBeginSection[]{              % Outline in every section
  \begin{frame}<handout:0>{Outline}
    \tableofcontents[currentsection]
  \end{frame}}

%% graphicx 
% \DeclareGraphicsExtensions{.png,.jpg,.mps,.pdf,.gif,.tif}

\mode<handout> {                % handout mode of beamer
  \hypersetup{%
    pdfpagemode=UseOutlines,    % 打开书签
    pdfstartview=Fit}
  \ifhandoutprint                 % print only handout
    \usepackage{pgfpages}         % 一页多帧
    \pgfpagesuselayout{2 on 1}[a4paper,border shrink=1mm]
    % \nofiles                    % 防止页码错误
    \lstset{basicstyle=\ttfamily\footnotesize, keywordstyle=\bfseries,
      keywordstyle=[2]\bfseries, commentstyle=\sl, emphstyle=\bfseries,
      emphstyle=[2]\bfseries, emphstyle=[3]\bfseries, emphstyle=[4]\sl,
      frame=none, framerule=0pt, backgroundcolor=\color{black!7},
      escapebegin=\sl, escapeend=, language=CSharp}
    \setbeamertemplate{background canvas}{}
    \setbeamertemplate{background}{}
    \setbeamertemplate{headline}{}
    \setbeamertemplate{footline}{}
    \setbeamertemplate{frametitle}[default][left]
    \setbeamercolor{frametitle}{fg=black,bg=white}
    \setbeamertemplate{blocks}[default]
    \setbeamercolor{block title}{bg=black!10,fg=black}
    \setbeamercolor{block body}{bg=black!5,fg=black}
    \setbeamercolor{block title example}{bg=blue!10,fg=black}
    \setbeamercolor{block body example}{bg=blue!5,fg=black}
    \setbeamercolor{block title alerted}{bg=red!10,fg=black}
    \setbeamercolor{block body alerted}{bg=red!5,fg=black}
    \logo{} \fi}

% macro definitions
\def\helplines{%
  \draw[->] (0,0)--(9,0);  \draw[->] (0,0)--(0,7.2);
  \draw[step=1cm,color=blue!40,very thin] (1pt,1pt) grid (8.9,6.9);
  \draw[step=1cm,color=black!40,dotted,very thin,shift={(-.5,-.5)}] (1pt+.5cm,1pt+.5cm) grid (9.5,7.5);
  \foreach \x in {1,2,...,7} \draw[font=\scriptsize]
  (\x,0) -- +(up:1pt) ++(down:4pt) node {$\x$}
  (0,\x) -- +(right:1pt) ++(left:3pt) node {$\x$};}
\def\wraphere{\tikz \draw[color=red!60!black,thick,->] (0ex,1.2ex) .. controls +(-10:1.2ex) and +(40:.2ex) .. (0,0);\\}
\def\cmd#1{\par\texttt{C:$\backslash> $\ {}#1}\par}
\def\redwarn{\color<handout:0>{red!65!black}}
\def\xnode #1#2#3#4{#1 +(.1,-.1) node[style=shnode] {} #1 node[style=outnode] (#2) {} +(up:.2cm) node {#3} %
  ++(down:.18cm) node[style=innode] (#4) {} node {Controls Collection}}
\def\CJKindent{\parindent 2em}

% Local Variables:
% mode: LaTeX
% coding: utf-8
% fill-column: 100
% End:
